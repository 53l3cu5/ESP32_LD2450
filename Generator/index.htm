<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configuration du Détecteur de Mouvement</title>
    <style>
        .indent {
            margin-left: 20px; /* Ajustez la valeur de la marge selon vos besoins */
        }
    </style>

</head>
<body>
    <header>
        <h1>Configuration du Détecteur de Mouvement</h1>
    </header>
    <main>
        <form id="config-form">
            <label for="zone-detection">Nombre de Zones de Détection :</label>
            <select id="zone-detection" name="zone-detection">
                <!-- Ajout des options de 1 à 10 -->
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
            </select>
            <br>
            <label for="cible-quitter-zone" class="indent">La cible doit quitter la zone :</label>
            <select id="cible-quitter-zone" name="cible-quitter-zone" class="indent">
                <!-- Options générées dynamiquement en JavaScript -->
            </select>
            <br>
            <br>
            <label for="zone-exclusion">Nombre de Zones d'Exclusion :</label>
            <select id="zone-exclusion" name="zone-exclusion">
                <option value="0">0</option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <!-- Ajoutez autant d'options que nécessaire -->
            </select>
            <br>
            <textarea id="generated-text" rows="10" cols="50" readonly></textarea> <!-- Zone de texte pour afficher le texte généré -->
            <br>
            <input type="submit" value="Générer et Télécharger">
        </form>
        <a id="download-link" style="display: none" download="LD2450.yaml">Télécharger</a> <!-- Lien de téléchargement caché -->
    </main>
    <footer>
        <p>© 2024 Configuration du Détecteur de Mouvement</p>
    </footer>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const zoneDetectionSelect = document.getElementById('zone-detection');
            const cibleQuitterZoneSelect = document.getElementById('cible-quitter-zone');

            zoneDetectionSelect.addEventListener('change', function () {
                const selectedOptionValue = parseInt(zoneDetectionSelect.value);
                updateCibleQuitterZoneOptions(selectedOptionValue);
            });

            function updateCibleQuitterZoneOptions(numOptions) {
                // Effacer les options actuelles
                cibleQuitterZoneSelect.innerHTML = '';
                // Ajouter de nouvelles options
                for (let i = 0; i <= numOptions; i++) {
                    const option = document.createElement('option');
                    option.value = i.toString();
                    option.textContent = i.toString();
                    cibleQuitterZoneSelect.appendChild(option);
                }
            }

            // Initialiser les options de la liste déroulante dès le chargement de la page
            updateCibleQuitterZoneOptions(parseInt(zoneDetectionSelect.value));
        });
    </script>

    <script>
        // Votre code JavaScript ici
        
        document.getElementById('config-form').addEventListener('submit', function(event) {
            event.preventDefault();
            const zonesDetection = parseInt(document.getElementById('zone-detection').value);
            const zonesExclusion = parseInt(document.getElementById('zone-exclusion').value);

            // Générer le texte pour les zones de détection
            let zonesDetectionText = '';
            for (let i = 1; i <= zonesDetection; i++) {
                zonesDetectionText += `
  - platform: template
    name: \${entity_name} Zone${i} Info
    id: tips_zone${i}_conf
    icon: mdi:information-outline
    entity_category: config
    lambda: |-
      return {"Configure below" };
    update_interval: 1000s
`;
            }

            // Générer le texte pour les zones d'exclusion
            let zonesExclusionText = '';
            for (let i = 1; i <= zonesExclusion; i++) {
                zonesExclusionText += `
  - platform: template
    name: \${entity_name} Zout${i} Info
    id: tips_zone_ex${i}_conf
    icon: mdi:information-outline
    entity_category: config
    lambda: |-
      return {"Zone Exclusion ${i}" };
    update_interval: 1000s
`;
            }

            // Fusionner les deux textes générés
            const finalText = zonesDetectionText + zonesExclusionText;

            // Afficher le texte généré dans la zone de texte
            const generatedTextArea = document.getElementById('generated-text');
            generatedTextArea.textContent = finalText;

            // Afficher le lien de téléchargement
            const downloadLink = document.getElementById('download-link');
            downloadLink.href = 'data:text/plain;charset=utf-8,' + encodeURIComponent(finalText);
            downloadLink.style.display = 'block'; // Afficher le lien

            // Mettre à jour le nom de fichier téléchargé
            downloadLink.setAttribute('download', `LD2450.yaml`);
        });
    </script>
</body>
</html>
